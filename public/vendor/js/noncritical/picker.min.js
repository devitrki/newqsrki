!function(e){"function"==typeof define&&define.amd?define("picker",["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):"object"==typeof window?window.Picker=e(jQuery):this.Picker=e(jQuery)}(function(y){var o=y(window),r=y(document),i=y(document.documentElement),_=null!=document.documentElement.style.transition;function $(a,d,u,e){if(!a)return $;function t(){return this.start()}var s=!1,c={id:a.id||"P"+Math.abs(~~(Math.random()*new Date)),handlingOpen:!1},l=u?y.extend(!0,{},u.defaults,e):e||{},f=y.extend({},$.klasses(),l.klass),p=y(a),h=t.prototype={constructor:t,$node:p,start:function(){return c&&c.start?h:(c.methods={},c.start=!0,c.open=!1,c.type=a.type,a.autofocus=a==x(),a.readOnly=!l.editable,a.id=a.id||c.id,"text"!=a.type&&(a.type="text"),h.component=new u(h,l),h.$root=y('<div class="'+f.picker+'" id="'+a.id+'_root" />'),k(h.$root[0],"hidden",!0),h.$holder=y(m()).appendTo(h.$root),g(),l.formatSubmit&&(!0===l.hiddenName?(i=a.name,a.name=""):i=(i=["string"==typeof l.hiddenPrefix?l.hiddenPrefix:"","string"==typeof l.hiddenSuffix?l.hiddenSuffix:"_submit"])[0]+a.name+i[1],h._hidden=y('<input type=hidden name="'+i+'"'+(p.data("value")||a.value?' value="'+h.get("select",l.formatSubmit)+'"':"")+">")[0],p.on("change."+c.id,function(){h._hidden.value=a.value?h.get("select",l.formatSubmit):""})),p.data(d,h).addClass(f.input).val(p.data("value")?h.get("select",l.format):a.value).on("focus."+c.id+" click."+c.id,(o=function(e){e.preventDefault(),h.open()},function(){var e=this,t=arguments;clearTimeout(r),r=setTimeout(function(){r=null,o.apply(e,t)},100)})).on("mousedown",function(){c.handlingOpen=!0;var e=function(){setTimeout(function(){y(document).off("mouseup",e),c.handlingOpen=!1},0)};y(document).on("mouseup",e)}),l.editable||p.on("keydown."+c.id,v),k(a,{haspopup:!0,expanded:!1,readonly:!1,owns:a.id+"_root"}),l.containerHidden?y(l.containerHidden).append(h._hidden):p.after(h._hidden),l.container?y(l.container).append(h.$root):p.after(h.$root),h.on({start:h.component.onStart,render:h.component.onRender,stop:h.component.onStop,open:h.component.onOpen,close:h.component.onClose,set:h.component.onSet}).on({start:l.onStart,render:l.onRender,stop:l.onStop,open:l.onOpen,close:l.onClose,set:l.onSet}),e=h.$holder[0],n="position",e.currentStyle?t=e.currentStyle[n]:window.getComputedStyle&&(t=getComputedStyle(e)[n]),s="fixed"==t,a.autofocus&&h.open(),h.trigger("start").trigger("render"));var e,t,n,o,r,i},render:function(e){return e?(h.$holder=y(m()),g(),h.$root.html(h.$holder)):h.$root.find("."+f.box).html(h.component.nodes(c.open)),h.trigger("render")},stop:function(){return c.start&&(h.close(),h._hidden&&h._hidden.parentNode.removeChild(h._hidden),h.$root.remove(),p.removeClass(f.input).removeData(d),setTimeout(function(){p.off("."+c.id)},0),a.type=c.type,a.readOnly=!1,h.trigger("stop"),c.methods={},c.start=!1),h},open:function(e){return c.open?h:(p.addClass(f.active),k(a,"expanded",!0),setTimeout(function(){h.$root.addClass(f.opened),k(h.$root[0],"hidden",!1)},0),!1!==e&&(c.open=!0,s&&y("body").css("overflow","hidden").css("padding-right","+="+b()),s&&_?h.$holder.find("."+f.frame).one("transitionend",function(){h.$holder.eq(0).focus()}):setTimeout(function(){h.$holder.eq(0).focus()},0),r.on("click."+c.id+" focusin."+c.id,function(e){var t;c.handlingOpen||(t=w(e,a),e.isSimulated||t==a||t==document||3==e.which||h.close(t===h.$holder[0]))}).on("keydown."+c.id,function(e){var t=e.keyCode,n=h.component.key[t],o=w(e,a);27==t?h.close(!0):o!=h.$holder[0]||!n&&13!=t?y.contains(h.$root[0],o)&&13==t&&(e.preventDefault(),o.click()):(e.preventDefault(),n?$._.trigger(h.component.key.go,h,[$._.trigger(n)]):h.$root.find("."+f.highlighted).hasClass(f.disabled)||(h.set("select",h.component.item.highlight),l.closeOnSelect&&h.close(!0)))})),h.trigger("open"))},close:function(e){return e&&(l.editable?a.focus():(h.$holder.off("focus.toOpen").focus(),setTimeout(function(){h.$holder.on("focus.toOpen",n)},0))),p.removeClass(f.active),k(a,"expanded",!1),setTimeout(function(){h.$root.removeClass(f.opened+" "+f.focused),k(h.$root[0],"hidden",!0)},0),c.open?(c.open=!1,s&&y("body").css("overflow","").css("padding-right","-="+b()),r.off("."+c.id),h.trigger("close")):h},clear:function(e){return h.set("clear",null,e)},set:function(e,t,n){var o,r,i=y.isPlainObject(e),a=i?e:{};if(n=i&&y.isPlainObject(t)?t:n||{},e){for(o in i||(a[e]=t),a)r=a[o],o in h.component.item&&(void 0===r&&(r=null),h.component.set(o,r,n)),"select"!=o&&"clear"!=o||!l.updateInput||p.val("clear"==o?"":h.get(o,l.format)).trigger("change");h.render()}return n.muted?h:h.trigger("set",a)},get:function(e,t){if(null!=c[e=e||"value"])return c[e];if("valueSubmit"==e){if(h._hidden)return h._hidden.value;e="value"}if("value"==e)return a.value;if(e in h.component.item){if("string"!=typeof t)return h.component.get(e);var n=h.component.get(e);return n?$._.trigger(h.component.formats.toString,h.component,[t,n]):""}},on:function(e,t,n){var o,r,i=y.isPlainObject(e),a=i?e:{};if(e)for(o in i||(a[e]=t),a)r=a[o],n&&(o="_"+o),c.methods[o]=c.methods[o]||[],c.methods[o].push(r);return h},off:function(){var e,t=arguments,n=0;for(namesCount=t.length;n<namesCount;n+=1)(e=t[n])in c.methods&&delete c.methods[e];return h},trigger:function(e,n){function t(e){var t=c.methods[e];t&&t.map(function(e){$._.trigger(e,h,[n])})}return t("_"+e),t(e),h}};function m(){return $._.node("div",$._.node("div",$._.node("div",$._.node("div",h.component.nodes(c.open),f.box),f.wrap),f.frame),f.holder,'tabindex="-1"')}function g(){h.$holder.on({keydown:v,"focus.toOpen":n,blur:function(){p.removeClass(f.target)},focusin:function(e){h.$root.removeClass(f.focused),e.stopPropagation()},"mousedown click":function(e){var t=w(e,a);t!=h.$holder[0]&&(e.stopPropagation(),"mousedown"!=e.type||y(t).is("input, select, textarea, button, option")||(e.preventDefault(),h.$holder.eq(0).focus()))}}).on("click","[data-pick], [data-nav], [data-clear], [data-close]",function(){var e=y(this),t=e.data(),n=e.hasClass(f.navDisabled)||e.hasClass(f.disabled),o=(o=x())&&(o.type||o.href?o:null);(n||o&&!y.contains(h.$root[0],o))&&h.$holder.eq(0).focus(),!n&&t.nav?h.set("highlight",h.component.item.highlight,{nav:t.nav}):!n&&"pick"in t?(h.set("select",t.pick),l.closeOnSelect&&h.close(!0)):t.clear?(h.clear(),l.closeOnClear&&h.close(!0)):t.close&&h.close(!0)})}function n(e){e.stopPropagation(),p.addClass(f.target),h.$root.addClass(f.focused),h.open()}function v(e){var t=e.keyCode,n=/^(8|46)$/.test(t);if(27==t)return h.close(!0),!1;(32==t||n||!c.open&&h.component.key[t])&&(e.preventDefault(),e.stopPropagation(),n?h.clear().close():h.open())}return new t}function b(){if(i.height()<=o.height())return 0;var e=y('<div style="visibility:hidden;width:100px" />').appendTo("body"),t=e[0].offsetWidth;e.css("overflow","scroll");var n=y('<div style="width:100%" />').appendTo(e)[0].offsetWidth;return e.remove(),t-n}function w(e,t){var n=[];return e.path&&(n=e.path),e.originalEvent&&e.originalEvent.path&&(n=e.originalEvent.path),n&&0<n.length?t&&0<=n.indexOf(t)?t:n[0]:e.target}function k(e,t,n){if(y.isPlainObject(t))for(var o in t)a(e,o,t[o]);else a(e,t,n)}function a(e,t,n){e.setAttribute(("role"==t?"":"aria-")+t,n)}function x(){try{return document.activeElement}catch(e){}}return $.klasses=function(e){return{picker:e=e||"picker",opened:e+"--opened",focused:e+"--focused",input:e+"__input",active:e+"__input--active",target:e+"__input--target",holder:e+"__holder",frame:e+"__frame",wrap:e+"__wrap",box:e+"__box"}},$._={group:function(e){for(var t,n="",o=$._.trigger(e.min,e);o<=$._.trigger(e.max,e,[o]);o+=e.i)t=$._.trigger(e.item,e,[o]),n+=$._.node(e.node,t[0],t[1],t[2]);return n},node:function(e,t,n,o){return t?"<"+e+(n=n?' class="'+n+'"':"")+(o=o?" "+o:"")+">"+(t=y.isArray(t)?t.join(""):t)+"</"+e+">":""},lead:function(e){return(e<10?"0":"")+e},trigger:function(e,t,n){return"function"==typeof e?e.apply(t,n||[]):e},digits:function(e){return/\d/.test(e[1])?2:1},isDate:function(e){return-1<{}.toString.call(e).indexOf("Date")&&this.isInteger(e.getDate())},isInteger:function(e){return-1<{}.toString.call(e).indexOf("Number")&&e%1==0},ariaAttr:function(e,t){for(var n in y.isPlainObject(e)||(e={attribute:t}),t="",e){var o=("role"==n?"":"aria-")+n;t+=null==e[n]?"":o+'="'+e[n]+'"'}return t}},$.extend=function(o,r){y.fn[o]=function(e,t){var n=this.data(o);return"picker"==e?n:n&&"string"==typeof e?$._.trigger(n[e],n,[t]):this.each(function(){y(this).data(o)||new $(this,o,r,e)})},y.fn[o].defaults=r.defaults},$});